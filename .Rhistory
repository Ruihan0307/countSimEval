if_plot = TRUE,
color_by = "group",
n_pc = 20)
simu_sce1$group <- simu_sce1$cell_type
simu_sce2$group <- simu_sce2$Group
compare_figure <- plot_reduceddim(ref_sce = simu_sce1,
sce_list = list(simu_sce2),
name_vec = c("Reference", "simu"),
assay_use = "counts",
if_plot = TRUE,
color_by = "group",
n_pc = 20)
plot(compare_figure$p_umap)
table(simu_sce2$Group)
#新排序
simu_sce1 <- simu_sce1[, order(colData(simu_sce1)$cell_type)]
simu_sce2 <- simu_sce2[, order(colData(simu_sce2)$Group)]
simu_sce1$group <- simu_sce1$cell_type
simu_sce2$group <- simu_sce2$Group
simu_sce1$group
simu_sce2$group
#名称记得修改
ddsList <- list(origin = simu_sce1, ESCO = simu_sce2)
result <- calculateDEGsParameters(ddsList)
View(result)
table(result$DEGs$origin$Gp1vsGp2$change)
table(result$DEGs$ESCO$Gp1vsGp2$change)
table(result$DEGs$ESCO$Gp1vsGp4$change)
table(result$DEGs$ESCO$Gp1vsGp5$change)
table(result$DEGs$ESCO$Gp2vsGp3$change)
write.csv(result$results,"E:/R_Files/DEGs_parameters/DuoClustering2018/ESCO_full_Zhengmix4eq_DEGs" , row.names = FALSE)
saveRDS(result,"E:/R_Files/DEGs_parameters/DuoClustering2018/ESCO_full_Zhengmix4eq_DEGs.rds")
write.csv(result$results,"E:/R_Files/DEGs_parameters/DuoClustering2018/ESCO_full_Zhengmix4eq_DEGs.xlsx" , row.names = FALSE)
saveRDS(result,"E:/R_Files/DEGs_parameters/DuoClustering2018/ESCO_full_Zhengmix4eq_DEGs.rds")
write.csv(result$results,"E:/R_Files/DEGs_parameters/DuoClustering2018/ESCO_full_Zhengmix4eq_DEGs.csv" , row.names = FALSE)
rm(list = ls())
source("R/calcDEGs.R")
simu_sce1 <- readRDS("E:/Datas/DuoClustering2018/sce_full/filtered/filtered_sce_full_Zhengmix4eq.rds")
simu_sce2 <- readRDS("E:/Datas/DuoClustering2018/sce_full/simu/GLMSim_sce_full_Zhengmix4eq.rds")
colData(simu_sce2)
#修改顺序
table(simu_sce1$cell_type)
table(simu_sce2$celltype)
dim(simu_sce1)
dim(simu_sce2)
#新排序
simu_sce1 <- simu_sce1[, order(colData(simu_sce1)$cell_type)]
simu_sce2 <- simu_sce2[, order(colData(simu_sce2)$celltype)]
all(simu_sce1$cell_type == simu_sce2$celltype)
simu_sce2$celltype
simu_sce1$group <- simu_sce1$cell_type
simu_sce2$group <- simu_sce2$celltype
compare_figure <- plot_reduceddim(ref_sce = simu_sce1,
sce_list = list(simu_sce2),
name_vec = c("Reference", "simu"),
assay_use = "counts",
if_plot = TRUE,
color_by = "group",
n_pc = 20)
dim(simu_sce1)
dim(simu_sce2)
compare_figure <- plot_reduceddim(ref_sce = simu_sce1[1:12299,],
sce_list = list(simu_sce2),
name_vec = c("Reference", "simu"),
assay_use = "counts",
if_plot = TRUE,
color_by = "group",
n_pc = 20)
plot(compare_figure$p_umap)
#名称记得修改
ddsList <- list(origin = simu_sce1, GLMSim = simu_sce2)
result <- calculateDEGsParameters(ddsList)
View(result)
write.csv(result$results,"E:/R_Files/DEGs_parameters/DuoClustering2018/GLMSim_full_Zhengmix4eq_DEGs.csv" , row.names = FALSE)
saveRDS(result,"E:/R_Files/DEGs_parameters/DuoClustering2018/GLMSim_full_Zhengmix4eq_DEGs.rds")
devtools::install_github("dynverse/ti_slingshot/package/", force = TRUE)
rm(list = ls())
origin_sce <- readRDS("E:/Datas/Traj/EH5415/origin/EH5415_sce.rds")
ref_data_grouping <- origin_sce$celltype
ref_data <- as.matrix(assays(origin_sce)$counts)
ref_data <- dynwrap::wrap_expression(counts = t(ref_data),
expression = log2(t(ref_data) + 1))
ref_data_transformation <- TRUE
#添加group
ref_data <- dynwrap::add_grouping(dataset = ref_data,
grouping = ref_data_grouping)
verbose <- TRUE
ref_model <- dynwrap::infer_trajectory(dataset = ref_data,
method = tislingshot::ti_slingshot(),
parameters = NULL,
give_priors = NULL,
seed = 123,
verbose = verbose)
rm(list = ls())
rm(list=ls())
source("R/hello.R")
source("R/makeDF.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/calculateCorrelations.R")
source("R/StandardizedCalculationScore.R")
origin_sce <- readRDS("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
simu_sce1 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/GLMSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce2 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/hierarchicell_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce3 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/MOSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce4 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/muscat_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$counts)
simu2 <- as.matrix(assays(simu_sce2)$counts)
simu3 <- as.matrix(assays(simu_sce3)$counts)
simu4 <- as.matrix(assays(simu_sce4)$counts)
ddList <- list( origin = origin, GLMSim = simu1, hierarchicell = simu2, MOSim = simu3, muscat = simu4)
test <- hello(ddList)
library(Matrix)
library(Matrix)
library(edgeR)
library(dplyr)
library(KernSmooth)
library(SummarizedExperiment)
library(genefilter)
library(fasano.franceschini.test)
library(SingleCellExperiment)
library(cluster)
library(stats)
library(scater)
library(ks)
origin_sce <- readRDS("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
simu_sce1 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/GLMSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce2 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/hierarchicell_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce3 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/MOSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce4 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/muscat_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$counts)
simu2 <- as.matrix(assays(simu_sce2)$counts)
simu3 <- as.matrix(assays(simu_sce3)$counts)
simu4 <- as.matrix(assays(simu_sce4)$counts)
ddList <- list( origin = origin, GLMSim = simu1, hierarchicell = simu2, MOSim = simu3, muscat = simu4)
test <- hello(ddList)
View(test)
df <- StandardizedCalculationScore(tmp_list = test)
View(df)
BiocManager::install("SingleR")
devtools::install_github('dviraran/SingleR')
BiocManager::repositories()
options(BioC_mirror = "https://mirrors.tuna.tsinghua.edu.cn/bioconductor")
BiocManager::repositories()
BiocManager::install("GSEABase")
BiocManager::install("GSVA")
BiocManager::install("singscore")
options(BioC_mirror = "https://bioconductor.org")
BiocManager::repositories()
BiocManager::install("singscore")
BiocManager::install("GSVA")
BiocManager::install("singscore")
library(Matrix)
library(edgeR)
library(dplyr)
library(KernSmooth)
library(DESeq2)
library(SummarizedExperiment)
library(genefilter)
library(fasano.franceschini.test)
library(SingleCellExperiment)
library(cluster)
library(stats)
library(scater)
library(ks)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
origin_sce <- readRDS("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
simu_sce1 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/GLMSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce2 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/hierarchicell_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$counts)
simu2 <- as.matrix(assays(simu_sce2)$counts)
ddList <- list( origin = origin, GLMSim = simu1, hierarchicell = simu2)
test <- hello(ddList)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
origin_sce <- readRDS("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
simu_sce1 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/GLMSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce2 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/hierarchicell_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce3 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/SPARSim_SCE_SCP425_smart-seq2_Cortex1.rds")
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$counts)
simu2 <- as.matrix(assays(simu_sce2)$counts)
simu3 <- as.matrix(assays(simu_sce3)$counts)
ddList <- list( origin = origin, GLMSim = simu1, hierarchicell = simu2, SPARSim = simu3)
test <- hello(ddList)
df <- StandardizedCalculationScore(tmp_list = test)
View(df)
View(df$Lib)
rm(list = ls())
origin_sce <- readH5AD("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
library(Matrix)
library(edgeR)
library(dplyr)
library(KernSmooth)
library(DESeq2)
library(SummarizedExperiment)
library(genefilter)
library(fasano.franceschini.test)
library(SingleCellExperiment)
library(cluster)
library(stats)
library(scater)
library(ks)
origin_sce <- readH5AD("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")
library(zellkonverter)
origin_sce <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/origin/filtered_293T_jurkat.h5ad")
origin_sce <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/origin/filtered_293T_jurkat.h5ad")
simu_sce1 <- readRDS("E:/Datas/PythonDatas/293T_jurkat/simu/LSH-GAN_sim.h5ad")
origin_sce
View(origin_sce)
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scDiffusion_sim_cond_all.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scGAN_simu_293T_jurkat.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scVI_sim.h5ad")
View(simu_sce1)
View(simu_sce2)
View(simu_sce3)
View(simu_sce4)
View(simu_sce5)
View(simu_sce4)
View(simu_sce3)
View(simu_sce2)
View(simu_sce1)
origin <- as.matrix(assays(origin_sce)$counts)
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
View(simu1)
min(simu1)
View(simu3)
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
View(ddList)
rm(origin)
rm(origin_sce)
rm(simu_sce1)
rm(simu_sce2)
rm(simu_sce3)
rm(simu_sce4)
rm(simu_sce5)
rm(simu1)
rm(simu2)
rm(simu3)
rm(simu4)
rm(simu5)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
test <- hello(ddList)
rm(list = ls())
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
origin_sce <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/origin/filtered_293T_jurkat.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scDiffusion_sim_cond_all.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scGAN_simu_293T_jurkat.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/293T_jurkat/simu/scVI_sim.h5ad")
origin <- as.matrix(assays(origin_sce)$counts)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
simu1[simu1 < 0] <- 0
View(simu1)
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
simu1
dim(simu1)
dim(simu2)
dim(simu3)
dim(simu4)
dim(simu5)
rm(origin)
rm(origin_sce)
rm(simu_sce1)
rm(simu_sce2)
rm(simu_sce3)
rm(simu_sce34)
rm(simu_sce4)
rm(simu_sce5)
rm(simu1)
rm(simu2)
rm(simu3)
rm(simu4)
rm(simu5)
test <- hello(ddList)
View(test)
View(test$AveLogCPM_Tagwise)
saveRDS(test,"E:/R_Files/countsimQC/countsimQC_report/Pythonresult/293T_jurkat_result.rds")
rm(list = ls())
origin_sce <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/origin/filtered_full_Zhengmix4eq.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/scDiffusion_sim_cond_all")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/scDiffusion_sim_cond_all.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/scGAN_simu_full_Zhengmix4eq.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/DuoClustering2018/simu/scVI_simu_full_Zhengmix4eq.h5ad")
origin <- as.matrix(assays(origin_sce)$counts)
origin <- as.matrix(assays(origin_sce)$X)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
test <- hello(ddList)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
test <- hello(ddList)
simu1[simu1 < 0] <- 0  #将负数转化为0
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
test <- hello(ddList)
df
saveRDS(test,"E:/R_Files/countsimQC/countsimQC_report/Pythonresult/full_Zhengmix4eq_result.rds")
View(test)
View(test)
rm(list = ls())
origin_sce <- readH5AD("E:/Datas/PythonDatas/MouseBrain/origin/filtered_MouseBrain.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scDiffusion_sim_cond_all.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scGAN_simu_MouseBrain.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scVI_simu_MouseBrain.h5ad")
origin <- as.matrix(assays(origin_sce)$X)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
dim(simu3)
dim(simu2)
simu2
table(simu_sce2$label)
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scDiffusion_simu_MouseBrain.h5ad")
simu2 <- as.matrix(assays(simu_sce2)$X)
dim(simu2)
origin_sce <- readH5AD("E:/Datas/PythonDatas/MouseBrain/origin/filtered_MouseBrain.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scDiffusion_simu_MouseBrain.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scGAN_simu_MouseBrain.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/MouseBrain/simu/scVI_simu_MouseBrain.h5ad")
origin <- as.matrix(assays(origin_sce)$X)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
simu1[simu1 < 0] <- 0  #将负数转化为0
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
test <- hello(ddList)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
test <- hello(ddList)
View(test)
saveRDS(test,"E:/R_Files/countsimQC/countsimQC_report/Pythonresult/MouseBrain_result.rds")
rm(list = ls())
origin_sce <- readH5AD("E:/Datas/PythonDatas/Chen/origin/filtered_Chen-2019-RNA.h5ad")
dim(origin_sce)
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/Chen/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/Chen/simu/scDiffusion_simu_Chen.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/Chen/simu/scGAN_simu_Chen-2019-RNA.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/Chen/simu/scRDiT_simu_Chen.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/Chen/simu/scVI_simu_Chen.h5ad")
dim(simu_sce4)
simu_sce3
table(simu_sce3$cluster)
simu_sce5
origin <- as.matrix(assays(origin_sce)$X)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
simu1[simu1 < 0] <- 0  #将负数转化为0
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
test <- hello(ddList)
saveRDS(test,"E:/R_Files/countsimQC/countsimQC_report/Pythonresult/Chen_result.rds")
rm(list = ls())
test <- readRDS("E:/Datas/PythonDatas/InHouse/origin/rna.h5ad")
test <- readH5AD("E:/Datas/PythonDatas/InHouse/origin/rna.h5ad")
table(test$cell_type)
dim(test)
test$cell_type
test <- readH5AD("E:/Datas/PythonDatas/InHouse/origin/filtered_rna.h5ad")
test$cell_type
test <- logNormCounts(test)
assays(test)$counts <- assays(test)$X
test <- logNormCounts(test)
test <- runPCA(test)
plotPCA(test, color_by = "celltype")
plotPCA(test, color_by = "cell_type")
library(zellkonverter)
sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/LSH-GAN_sim.h5ad")
dim(sce)
sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scDiffusion_simu_PBMC10K.h5ad")
dim(sce)
sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scGAN_simu_PBMC10K.h5ad")
dim(sce)
sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scRDiT_sim.h5ad")
dim(sce)
sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scVI_sim.h5ad")
dim(sce)
rm(list = ls())
origin_sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/origin/filtered_10x-Multiome-Pbmc10k-RNA.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scDiffusion_simu_Chen.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scDiffusion_simu_PBMC10K.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scGAN_simu_PBMC10K.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scVI_sim.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scRDiT_sim.h5ad")
dim(simu_sce3)
dim(simu_sce2)
dim(simu_sce4)
dim(simu_sce5)
dim(simu_sce1)
dim(origin_sce)
origin_sce <- readH5AD("E:/Datas/PythonDatas/PBMC10K/origin/filtered_10x-Multiome-Pbmc10k-RNA.h5ad")
simu_sce1 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/LSH-GAN_sim.h5ad")
simu_sce2 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scDiffusion_simu_PBMC10K.h5ad")
simu_sce3 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scGAN_simu_PBMC10K.h5ad")
simu_sce4 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scRDiT_sim.h5ad")
simu_sce5 <- readH5AD("E:/Datas/PythonDatas/PBMC10K/simu/scVI_sim.h5ad")
dim(origin_sce)
dim(simu_sce1)
dim(simu_sce2)
dim(simu_sce3)
dim(simu_sce4)
dim(simu_sce5)
origin <- as.matrix(assays(origin_sce)$X)
library(Matrix)
library(edgeR)
library(dplyr)
library(KernSmooth)
library(DESeq2)
library(SummarizedExperiment)
library(genefilter)
library(fasano.franceschini.test)
library(SingleCellExperiment)
library(cluster)
library(stats)
library(scater)
library(ks)
library(zellkonverter)
origin <- as.matrix(assays(origin_sce)$X)
simu1 <- as.matrix(assays(simu_sce1)$X)
simu2 <- as.matrix(assays(simu_sce2)$X)
simu3 <- as.matrix(assays(simu_sce3)$X)
simu4 <- as.matrix(assays(simu_sce4)$X)
simu5 <- as.matrix(assays(simu_sce5)$X)
min(simu1)
simu1[simu1 < 0] <- 0  #将负数转化为0
ddList <- list( origin = origin, LSH_GAN = simu1, scDiffusion = simu2, scGAN = simu3, scRDiT = simu4, scVI = simu5)
test <- hello(ddList)
source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
test <- hello(ddList)
rm(origin)
rm(simu_sce1)
rm(simu_sce2)
rm(simu_sce3)
rm(simu_sce4)
rm(simu_sce5)
rm(origin_sce)
rm(simu1)
rm(simu2)
rm(simu3)
rm(simu4)
rm(simu5)
test <- hello(ddList)
saveRDS(test,"E:/R_Files/countsimQC/countsimQC_report/Pythonresult/PBMC10K_result.rds")
