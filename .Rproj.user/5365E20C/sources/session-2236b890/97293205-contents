source("R/hello.R")
source("R/calculateCorrelations.R")
source("R/calculateDispersionsddsList.R")
source("R/calculateStats.R")
source("R/makeDF.R")
source("R/StandardizedCalculationScore.R")
library("dplyr")
rm(list = ls())
set.seed(123)
origin_sce <- readRDS("E:/Datas/SCP425/filtered/filtered_SCP425_smart-seq2_SCE_Cortex1.rds")

#simu_sce1 <- readRDS("E:/Datas/PythonDatas/InHouse/simu/scDesign3_simu_InHouse.rds")
#simu_sce2 <- readRDS("E:/Datas/PythonDatas/InHouse/simu/splat_simu_InHouse.rds")
#simu_sce3 <- readRDS("E:/Datas/PythonDatas/InHouse/simu/SCRIP-BGP-trendedBCV_simu_InHouse.rds")

simu_sce1 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/GLMSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce2 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/hierarchicell_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce3 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/MOSim_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce4 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/muscat_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce5 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/POWSC_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce6 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/scDD_sce_SCP425_smart-seq2_Cortex1.rds")
simu_sce7 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/scDesign2_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce8 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/scDesign3_simu_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce9 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/SCRIP_BGP-commonBCV_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce10 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/SPARSim_SCE_SCP425_smart-seq2_Cortex1.rds")
simu_sce11 <- readRDS("E:/Datas/SCP425/simu/smart-seq2/ZINB-WaVE_sce_SCP425_smart-seq2_Cortex1.rds")

origin <- as.matrix(assays(origin_sce)$counts)

simu1 <- as.matrix(assays(simu_sce1)$counts)
simu2 <- as.matrix(assays(simu_sce2)$counts)
simu3 <- as.matrix(assays(simu_sce3)$counts)
simu4 <- as.matrix(assays(simu_sce4)$counts)
simu5 <- as.matrix(assays(simu_sce5)$counts)
simu6 <- as.matrix(assays(simu_sce6)$normcounts)
simu7 <- as.matrix(assays(simu_sce7)$counts)
simu8 <- as.matrix(assays(simu_sce8)$counts)
simu9 <- as.matrix(assays(simu_sce9)$counts)
simu10 <- as.matrix(assays(simu_sce10)$counts)
simu11 <- as.matrix(assays(simu_sce11)$counts)
ddList <- list( origin = origin, GLMSim = simu1, hierarchicell = simu2, MOSim = simu3, muscat = simu4,
                POWSC = simu5, scDD = simu6, scDesign2 = simu7, scDesign3 = simu8,
                SCRIP_BGP_commonBCV = simu9, SPARSim = simu10, ZINB_WaVE = simu11)



test <- hello(ddList)

df <- StandardizedCalculationScore(tmp_list = test)


