library(Seurat)
library(cluster)
library(scater)
library(SingleCellExperiment)
library(stats)
library(zellkonverter)
library(DESeq2)
library(edgeR)
library(ggplot2)
library(scDesign3)
library(kBET)

rm(list = ls())

source("R/calculateBatchParameters.R")


sce <- readRDS("E:/Datas/Batch/293T/origin/filtered_adj_293T.rds")
sce <- readRDS("E:/Datas/Batch/DuoClustering2018_Bcell/simu/splat_simu_Bcells_Batch.rds")

matrix <- assays(sce)$counts


sce$Batch <- sce$cell_type
#list <- list(origin = matrix, scDesign3 = matrix1)

SCEList <- list(origin = sce, sce1 = sce)

result1 <- calculateBatchParameters(SCEList)

#saveRDS(result1, "E:/R_Files/Batch_parameters/DuoClustering2018_Bcell/Batch_splat.rds")
